"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7080],{550:(e,r,t)=>{t.d(r,{A:()=>d,db:()=>o,j:()=>l});var a=t(2078),s=t(1328),i=t(9708);let n=(0,a.Wp)({apiKey:"AIzaSyC_BJxgcR3pEigciKLRLi_bfHhqAY291aY",authDomain:"kakanga-constructions.firebaseapp.com",projectId:"kakanga-constructions",storageBucket:"kakanga-constructions.firebasestorage.app",messagingSenderId:"336607572164",appId:"1:336607572164:web:26ebff176627f98c419991"}),l=(0,s.xI)(n),o=(0,i.aU)(n),d=n},3209:(e,r,t)=>{t.d(r,{BT:()=>d,Wu:()=>c,ZB:()=>o,Zp:()=>n,aR:()=>l});var a=t(5155),s=t(2115),i=t(5016);let n=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s})});n.displayName="Card";let l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",t),...s})});l.displayName="CardHeader";let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("h3",{ref:r,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",t),...s})});o.displayName="CardTitle";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("p",{ref:r,className:(0,i.cn)("text-sm text-muted-foreground",t),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,i.cn)("p-6 pt-0",t),...s})});c.displayName="CardContent",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,i.cn)("flex items-center p-6 pt-0",t),...s})}).displayName="CardFooter"},3810:(e,r,t)=>{t.d(r,{AuthProvider:()=>u,A:()=>c});var a=t(5155),s=t(2115),i=t(1328),n=t(9708),l=t(550);class o{static async signIn(e,r){try{let a=(await (0,i.x9)(l.j,e,r)).user;try{let e=await (0,n.x7)((0,n.H9)(l.db,"users",a.uid));if(e.exists()){var t;let r=e.data();try{await (0,n.BN)((0,n.H9)(l.db,"users",a.uid),{...r,lastLogin:new Date},{merge:!0})}catch(e){console.warn("Could not update last login:",e)}return{id:a.uid,email:a.email,displayName:a.displayName||r.displayName,role:r.role||"admin",createdAt:(null==(t=r.createdAt)?void 0:t.toDate())||new Date,lastLogin:new Date}}}catch(e){console.warn("Firestore unavailable, using basic auth:",e)}let s={id:a.uid,email:a.email,displayName:a.displayName||a.email.split("@")[0],role:"admin",createdAt:new Date,lastLogin:new Date};try{await (0,n.BN)((0,n.H9)(l.db,"users",a.uid),{email:s.email,displayName:s.displayName,role:s.role,createdAt:new Date,lastLogin:new Date})}catch(e){console.warn("Could not create user document:",e)}return s}catch(e){throw console.error("Sign in error:",e),e}}static async signUp(e,r,t){try{let a=(await (0,i.eJ)(l.j,e,r)).user;await (0,i.r7)(a,{displayName:t});let s={email:a.email,displayName:t,role:"editor",createdAt:new Date,lastLogin:new Date};return await (0,n.BN)((0,n.H9)(l.db,"users",a.uid),s),{id:a.uid,...s}}catch(e){throw console.error("Sign up error:",e),e}}static async signOut(){try{await (0,i.CI)(l.j)}catch(e){throw console.error("Sign out error:",e),e}}static onAuthStateChange(e){return(0,i.hg)(l.j,async r=>{if(r)try{let s=await (0,n.x7)((0,n.H9)(l.db,"users",r.uid));if(s.exists()){var t,a;let i=s.data(),n={id:r.uid,email:r.email,displayName:r.displayName||i.displayName,role:i.role||"editor",createdAt:(null==(t=i.createdAt)?void 0:t.toDate())||new Date,lastLogin:null==(a=i.lastLogin)?void 0:a.toDate()};e(n)}else{let t={email:r.email,displayName:r.displayName||"",role:"editor",createdAt:new Date,lastLogin:new Date};await (0,n.BN)((0,n.H9)(l.db,"users",r.uid),t),e({id:r.uid,...t})}}catch(r){console.error("Error getting user data:",r),e(null)}else e(null)})}static getCurrentUser(){return l.j.currentUser}static async updateUserRole(e,r){try{return await (0,n.BN)((0,n.H9)(l.db,"users",e),{role:r},{merge:!0}),!0}catch(e){return console.error("Error updating user role:",e),!1}}}let d=(0,s.createContext)(void 0),c=()=>{let e=(0,s.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},u=e=>{let{children:r}=e,[t,i]=(0,s.useState)(null),[n,l]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let e=o.onAuthStateChange(e=>{i(e),l(!1)});return()=>e()},[]);let c={user:t,loading:n,signIn:async(e,r)=>{try{return await o.signIn(e,r)}catch(e){throw console.error("Sign in error:",e),e}},signUp:async(e,r,t)=>{try{return await o.signUp(e,r,t)}catch(e){throw console.error("Sign up error:",e),e}},signOut:async()=>{try{await o.signOut()}catch(e){throw console.error("Sign out error:",e),e}},isAuthenticated:!!t,isAdmin:(null==t?void 0:t.role)==="admin"};return(0,a.jsx)(d.Provider,{value:c,children:r})}},5016:(e,r,t)=>{t.d(r,{cn:()=>i});var a=t(2821),s=t(5889);function i(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,s.QP)((0,a.$)(r))}},7003:(e,r,t)=>{t.d(r,{Button:()=>d});var a=t(5155),s=t(2115),i=t(2467),n=t(3101),l=t(5016);let o=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-xs font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-3 [&_svg]:shrink-0 font-heading uppercase tracking-wide",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm hover:shadow-md",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",hero:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm hover:shadow-md border-2 border-primary hover:border-primary/80","hero-outline":"bg-transparent text-white border-2 border-white/30 hover:bg-white/10 hover:border-white/50",accent:"bg-accent text-accent-foreground hover:bg-accent/90 shadow-sm"},size:{default:"h-9 px-5 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 px-6 py-2 text-sm",xl:"h-11 px-7 py-3 text-sm",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,r)=>{let{className:t,variant:s,size:n,asChild:d=!1,...c}=e,u=d?i.DX:"button";return(0,a.jsx)(u,{className:(0,l.cn)(o({variant:s,size:n,className:t})),ref:r,...c})});d.displayName="Button"},8248:(e,r,t)=>{t.d(r,{A:()=>w});var a=t(5155),s=t(3810),i=t(63),n=t(2115),l=t(2619),o=t.n(l),d=t(9384),c=t(8734),u=t(5870),m=t(1169),h=t(9633),x=t(5229),g=t(9540),f=t(5993),p=t(4926),b=t(7003),y=t(2821);let v=[{name:"Dashboard",href:"/dashboard",icon:d.A},{name:"Projects",href:"/dashboard/projects",icon:c.A},{name:"Services",href:"/dashboard/services",icon:u.A},{name:"Staff",href:"/dashboard/staff",icon:m.A},{name:"Vacancies",href:"/dashboard/vacancies",icon:h.A}];function w(e){let{children:r}=e,{user:t,loading:l,signOut:d}=(0,s.A)(),c=(0,i.useRouter)(),[u,m]=(0,n.useState)(!1);(0,n.useEffect)(()=>{l||t||c.push("/login")},[t,l,c]);let h=async()=>{try{await d(),c.push("/login")}catch(e){console.error("Sign out error:",e)}};return l?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):t?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsxs)("div",{className:(0,y.A)("fixed inset-0 z-50 lg:hidden",u?"block":"hidden"),children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75",onClick:()=>m(!1)}),(0,a.jsxs)("div",{className:"fixed inset-y-0 left-0 flex w-64 flex-col bg-white",children:[(0,a.jsxs)("div",{className:"flex h-16 items-center justify-between px-4 border-b",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Dashboard"}),(0,a.jsx)("button",{onClick:()=>m(!1),className:"text-gray-500 hover:text-gray-700",children:(0,a.jsx)(x.A,{className:"h-6 w-6"})})]}),(0,a.jsx)("nav",{className:"flex-1 px-4 py-6 space-y-2",children:v.map(e=>(0,a.jsxs)(o(),{href:e.href,className:"flex items-center px-3 py-2 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-100",onClick:()=>m(!1),children:[(0,a.jsx)(e.icon,{className:"mr-3 h-5 w-5"}),e.name]},e.name))})]})]}),(0,a.jsx)("div",{className:"hidden lg:fixed lg:inset-y-0 lg:flex lg:w-64 lg:flex-col",children:(0,a.jsxs)("div",{className:"flex flex-col flex-1 min-h-0 bg-white border-r",children:[(0,a.jsx)("div",{className:"flex items-center h-16 px-4 border-b",children:(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Dashboard"})}),(0,a.jsx)("nav",{className:"flex-1 px-4 py-6 space-y-2",children:v.map(e=>(0,a.jsxs)(o(),{href:e.href,className:"flex items-center px-3 py-2 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-100",children:[(0,a.jsx)(e.icon,{className:"mr-3 h-5 w-5"}),e.name]},e.name))})]})}),(0,a.jsxs)("div",{className:"lg:pl-64",children:[(0,a.jsx)("div",{className:"sticky top-0 z-40 bg-white border-b px-4 py-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("button",{onClick:()=>m(!0),className:"lg:hidden text-gray-500 hover:text-gray-700 mr-4",children:(0,a.jsx)(g.A,{className:"h-6 w-6"})}),(0,a.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"Content Management"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)(o(),{href:"/",className:"text-sm text-blue-600 hover:underline flex items-center",children:[(0,a.jsx)(f.A,{className:"h-4 w-4 mr-1"}),"View Site"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-700",children:[(0,a.jsxs)("span",{children:["Welcome, ",t.displayName||t.email]}),(0,a.jsx)("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full",children:t.role})]}),(0,a.jsxs)(b.Button,{variant:"outline",size:"sm",onClick:h,className:"flex items-center",children:[(0,a.jsx)(p.A,{className:"h-4 w-4 mr-1"}),"Sign Out"]})]})]})}),(0,a.jsx)("main",{className:"p-4 sm:p-6 lg:p-8",children:r})]})]}):null}}}]);